{% load static %}
{% load partner_extras %}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Client Profile | Dashboard</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="{% static 'plugins/fontawesome-free/css/all.min.css' %}">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- SweetAlert2 -->
  <link rel="stylesheet" href="{% static 'plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css' %}">
  <!-- Tempusdominus Bbootstrap 4 -->
  <link rel="stylesheet" href="{% static 'plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css' %}">
  <!-- iCheck -->
  <link rel="stylesheet" href="{% static 'plugins/icheck-bootstrap/icheck-bootstrap.min.css' %}">
  <!-- JQVMap -->
  <link rel="stylesheet" href="{% static 'plugins/jqvmap/jqvmap.min.css' %}">
  <!-- DataTables -->
  <link rel="stylesheet" href="{% static 'plugins/datatables-bs4/css/dataTables.bootstrap4.css' %}">
  <!-- Theme style -->
  <link rel="stylesheet" href="{% static 'css/adminlte.min.css' %}">
  <!-- overlayScrollbars -->
  <link rel="stylesheet" href="{% static 'plugins/overlayScrollbars/css/OverlayScrollbars.min.css' %}">
  <!-- Daterange picker -->
  <link rel="stylesheet" href="{% static 'plugins/daterangepicker/daterangepicker.css' %}">
  <!-- summernote -->
  <link rel="stylesheet" href="{% static 'plugins/summernote/summernote-bs4.css' %}">
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
  <!-- Folder view -->
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/metismenu/dist/metisMenu.min.css">

   <style>
    .metisFolder {
      padding-left: 0;
    }
    .metisFolder, .metisFolder ul {
      list-style: none;
    }
    .metisFolder li {
      position: relative;
    }
    .metisFolder li a {
      display: block;
      padding-top: 5px;
      padding-bottom: 5px;
      color: #333;
      text-decoration: none;
      outline: 0 none;
    }
    .metisFolder ul:before {
      position: absolute;
      border-left: 1px dotted #333;
      content: "";
      width: 30px;
      top: 25px;
      left: 5px;
      bottom: 17px;
    }
    .metisFolder ul > li:before {
      position: absolute;
      border-top: 1px dotted #333;
      content: "";
      width: 30px;
      top: 13px;
      left: -33px;
    }
    li.active > a > span.fa-folder-o:before {
      content: "\f115" !important;
    }
   </style>
</head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">

  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="index3.html" class="nav-link">Home</a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="#" class="nav-link">Contact</a>
      </li>
    </ul>

    <!-- SEARCH FORM -->
    <form class="form-inline ml-3">
      <div class="input-group input-group-sm">
        <input class="form-control form-control-navbar" type="search" placeholder="Search" aria-label="Search">
        <div class="input-group-append">
          <button class="btn btn-navbar" type="submit">
            <i class="fas fa-search"></i>
          </button>
        </div>
      </div>
    </form>

    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <!-- Messages Dropdown Menu -->
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-comments"></i>
          <span class="badge badge-danger navbar-badge">3</span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <a href="#" class="dropdown-item">
            <!-- Message Start -->
            <div class="media">
              <img src="{% static 'img/user1-128x128.jpg' %}" alt="User Avatar" class="img-size-50 mr-3 img-circle">
              <div class="media-body">
                <h3 class="dropdown-item-title">
                  Brad Diesel
                  <span class="float-right text-sm text-danger"><i class="fas fa-star"></i></span>
                </h3>
                <p class="text-sm">Call me whenever you can...</p>
                <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
              </div>
            </div>
            <!-- Message End -->
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <!-- Message Start -->
            <div class="media">
              <img src="{% static 'img/user8-128x128.jpg' %}" alt="User Avatar" class="img-size-50 img-circle mr-3">
              <div class="media-body">
                <h3 class="dropdown-item-title">
                  John Pierce
                  <span class="float-right text-sm text-muted"><i class="fas fa-star"></i></span>
                </h3>
                <p class="text-sm">I got your message bro</p>
                <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
              </div>
            </div>
            <!-- Message End -->
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <!-- Message Start -->
            <div class="media">
              <img src="{% static 'img/user3-128x128.jpg' %}" alt="User Avatar" class="img-size-50 img-circle mr-3">
              <div class="media-body">
                <h3 class="dropdown-item-title">
                  Nora Silvester
                  <span class="float-right text-sm text-warning"><i class="fas fa-star"></i></span>
                </h3>
                <p class="text-sm">The subject goes here</p>
                <p class="text-sm text-muted"><i class="far fa-clock mr-1"></i> 4 Hours Ago</p>
              </div>
            </div>
            <!-- Message End -->
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item dropdown-footer">See All Messages</a>
        </div>
      </li>
      <!-- Notifications Dropdown Menu -->
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-bell"></i>
          <span class="badge badge-warning navbar-badge">15</span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <span class="dropdown-item dropdown-header">15 Notifications</span>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-envelope mr-2"></i> 4 new messages
            <span class="float-right text-muted text-sm">3 mins</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-users mr-2"></i> 8 friend requests
            <span class="float-right text-muted text-sm">12 hours</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-file mr-2"></i> 3 new reports
            <span class="float-right text-muted text-sm">2 days</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#">
          <i class="fas fa-th-large"></i>
        </a>
      </li>
    </ul>
  </nav>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="index3.html" class="brand-link">
      <img src="{% static 'img/AdminLTELogo.png' %}" alt="AdminLTE Logo" class="brand-image img-circle elevation-3"
           style="opacity: .8">
      <span class="brand-text font-weight-light">Audit System</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Sidebar user panel (optional) -->
      <div class="user-panel mt-3 pb-3 mb-3 d-flex">
        <div class="image">
          <img src="{% static 'img/user2-160x160.jpg' %}" class="img-circle elevation-2" alt="User Image">
        </div>
        <div class="info">
          <a href="#" class="d-block"> {{ request.user }}</a>
        </div>
      </div>

      {% include '../includes/sidebar.html' %}
    </div>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0 text-dark"></h1>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->
   <section class="content">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                    <i class="fas fa-list"></i>
                    Audit Plan Details
                    </h3>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <dl class="row">
                                <dt class="col-sm-4">Manager</dt>
                                <dd class="col-sm-8">{{ manager }}</dd>
                                <dt class="col-sm-4">Audit Plan Name</dt>
                                <dd class="col-sm-8">{{audit_plan.auditplanname}} for {{audit_plan.finance_year}}</dd>
                            </dl>
                        </div>
                        <div class="col-md-4">
                            <dl class="row">
                                <dt class="col-sm-4">Start Date</dt>
                                <dd class="col-sm-8">{{ audit_plan.start_date }}</dd>
                                <dt class="col-sm-4">Internal Deadline</dt>
                                <dd class="col-sm-8">{{audit_plan.estimated_end_date}}</dd>
                                <dt class="col-sm-4">Final Deadline</dt>
                                <dd class="col-sm-8">{{audit_plan.actual_end_date}}</dd>
                            </dl>
                        </div>
                        <div class="col-md-4">
                            <dl class="row">
                                <dt class="col-sm-4">Time Available</dt>
                                <dd class="col-sm-8">{{ time_available }} hours</dd>
                                <dt class="col-sm-4">Buffer</dt>
                                <dd class="col-sm-8">{{ buffer }} hours</dd>
                                <dt class="col-sm-4">Estimated Time Available</dt>
                                <dd class="col-sm-8"></dd>
                                <dt class="col-sm-4">Time Spent</dt>
                                <dd class="col-sm-8"></dd>
                            </dl>
                        </div>
                    </div>
                    
                </div>
                <!-- /.card-body -->
            </div>
            <!-- /.card -->
          </div>
          
        </div>

        
    </section>
    <!-- Main content -->
    <section class="content">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                      <h3 class="card-title">
                      <i class="fas fa-list"></i>
                      &nbsp;{{audit_plan.audittype}}
                      </h3>
                      {% if audit_plan.is_audit_plan_locked %}
                        <button type="button" class="btn btn-success float-right ml-4" data-toggle="modal" data-target="#unlockAuditPlanModal">
                        UNLOCK AUDIT PLAN
                      </button>
                      {% else %}
                      <button type="button" class="btn btn-success float-right ml-4" data-toggle="modal" data-target="#lockAuditPlanModal">
                        LOCK AUDIT PLAN
                      </button>
                      {% endif %}
                      
                  </div>
                    <div class="card-body table-responsive">
                      <!-- {% for i in client_tasks %}
                        {{i.tasks.task_estimated_days}}
                      {% endfor %} -->
                    <div class="table-responsive">
                      <table id="audit_plan" class="table table-bordered table-striped">
                          <thead>
                          <tr>
                              <th>Lables</th>
                              <th>Task Name</th>
                              <th>Task Status</th>
                              <th>Activity Name</th>
                              <th>Estimated Time</th>
                              <th>Task Type</th>
                              <th>Task Relevance</th>
                              <th>Task Volume</th>
                              <th>Sample Rate</th>
                              <th>Task Assigned To</th>
                              <th>Article Attachments</th>
                              <th>Auditor Attachments</th>
                              <th>Manager Attachments</th>
                              <th>Partner Attachments</th>
                              <th>Manager feedback</th>
                              <th>Partner feedback</th>
                          </tr>
                          </thead>
                              <tbody>
                                    {% for ct in client_tasks %}
                                          <tr>
                                            <td> {{ ct.tasks.activity.label }}</td>
                                            <td> <a href="{% url 'pending_approval_task' task_id=ct.tasks.id %}"> {{ ct.tasks.task_name }} </a></td>
                                            <td> 
                                              {% if ct.tasks.is_approved_partner == True %}
                                                <strong class="text-success">Completed  </strong>
                                              {% else %}
                                                <strong class="text-danger">Pending</strong>
                                              {% endif %}
                                              <!-- {% if ct.tasks.is_approved_partner == True %}
                                                <strong class="text-success">Completed</strong>
                                              {% else %}
                                              <strong class="text-danger">Pending</strong>
                                              {% endif %} -->
                                            </td>
                                            <td> {{ ct.tasks.activity }}</td>
                                            <td> {{ ct.estimated_time }} Hours</td>
                                            <td> {{ ct.tasks.task_type }} </td>
                                            <td> {{ ct.tasks.task_relevance }}</td>
                                            <td> {{ ct.tasks.task_volume }}</td>
                                            <td> {{ ct.tasks.task_sample_rate }}</td>
                                            <td> {{ ct.tasks.user }}</td>
                                            {% if ct.tasks.article_attachment_file %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn btn-primary" href="/media/{{ ct.article_upload }}" download="{{ ct.article_upload }}">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                              {% else %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                            {% endif %}
                                            {% if ct.tasks.auditor_attachment_file %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn btn-primary" href="/media/{{ ct.auditor_upload }}" download="{{ ct.auditor_upload }}">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                              {% else %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                            {% endif %}
                                            {% if ct.tasks.manager_attachment_file %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn btn-primary" href="/media/{{ ct.manager_upload }}" download="{{ ct.manager_upload }}">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                              {% else %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                            {% endif %}
                                            {% if ct.tasks.partner_attachment_file %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn btn-primary" href="/media/{{ ct.partner_upload }}" download="{{ ct.partner_upload }}">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                              {% else %}
                                              <td style="text-align:center;"> 
                                                <a role="btn" class="btn">
                                                  <i class="fas fa-paperclip" aria-hidden="true"></i>
                                                </a>
                                              </td>
                                            {% endif %}
                                            {% if ct.tasks.manager_feedback == "closed" %}
                                                <td style="text-align:center;"> 
                                                <div class="badge badge-success">
                                                  Closed
                                                </div>
                                                </td> 
                                              {% else %}
                                              <td style="text-align:center;"> 
                                                {{ ct.tasks.manager_feedback }}
                                              </td>
                                            {% endif %}
                                            {% if ct.tasks.partner_feedback == "closed" %}
                                                <td style="text-align:center;"> 
                                                <div class="badge badge-success">
                                                  Closed
                                                </div>
                                                </td> 
                                              {% else %}
                                              <td style="text-align:center;"> 
                                                {{ ct.tasks.partner_feedback }}
                                              </td>
                                              {% endif %}  
                                          </tr>
                                {% endfor %}
                              </tbody>
                      </table>
                      </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="lockAuditPlanModal" tabindex="-1">
            <div class="modal-dialog" role="document" style="max-width: 900px !important;">
                <div class="modal-content">
                    <form action="{% url 'lock_audit_plan' auditplan_id=audit_plan.id %}" method="POST" style="float:right">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Lock Audit Plan</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                      {% csrf_token %}
                      
                      <div class="modal-body">
                            <div class="form-row">
                              <div class="form-group col-md-12 mb-3">
                                  <label for="tasks" class="text-dark">ARE YOU SURE YOU WANT TO LOCK THE AUDIT PLAN ?</label>
                                  <br>
                                  <input type="checkbox" id="lock_audit_plan" name="lock_audit_plan" value="yes">
                                  <label for="yes">YES</label>
                                  <br>
                              </div>
                            </div>
                          
                            <div class="form-row" id="lock">
                              <div class="form-group col-md-12 mb-3">
                                <label for="password"> ENTER YOUR PASSWORD:</label>
                                <input type="password" class="form-control col-6" id="password" name="password">
                                <hr>
                              {% if audit_plan.is_billable == True and audit_plan.invoice_number is None%}
                                
                                <label for="start_billing" class="text-dark">DO YOU WANT TO START BILLING ?</label>
                                <br>
                                <input type="checkbox" id="start_billing" name="start_billing" value="yes">
                                <label for="yes">YES</label>
                                <div class="row" id="select">
                                  <div class="col-md-12 mb-4">
                                      <label for="invoice_number" class="text-dark">Enter Invoice Number</label>
                                      <input type="text" name="invoice_number" id="invoice_number" class="form-control"/>
                                  </div>
                                  <div class="col-md-12 mb-4">
                                      <label for="invoice_date" class="text-dark">Enter Invoice Date</label>
                                      <input type="date" name="invoice_date" id="invoice_date" class="form-control" />
                                  </div>
                                  <div class="col-md-12 mb-4">
                                      <label for="invoice_amount" class="text-dark">Enter Invoice Amount</label>
                                      <input type="text" name="invoice_amount" id="invoice_amount" class="form-control" />
                                  </div>
                                  <div class="col-md-6 mb-4">
                                    <label for="out_of_pocket" class="text-dark">Enter Out of pocket expenses</label>
                                    <input type="text" name="out_of_pocket" id="out_of_pocket" class="form-control" />
                                </div>
                                
                                <div class="col-md-6 mb-4">
                                    <label for="total_ope" class="text-dark">Out of pocket expenses Total</label>
                                    <input type="text" name="total_ope" id="total_ope" class="form-control" />
                                </div>
                                <div class="col-md-12 mb-4">
                                  <label for="tasks" class="text-dark">ADD GST TO OUT OF POCKET EXPENSES ?</label>
                                  <br>
                                  <input type="checkbox" id="ope_add_gst" name="ope_add_gst" value="yes">
                                  <label for="yes">YES</label>
                                </div>
                                <div class="row" id="selectope" style="width:100%;margin-left:1px">
                                  <div class="form-group col-md-4">
                                    <label for="ope_igst" class="text-dark">Out of pocket expenses IGST (in %)</label>
                                    <input type="number" name="ope_igst" id="ope_igst" class="form-control" value="0"/>
                                  </div>
                                  <div class="form-group col-md-4">
                                    <label for="ope_sgst" class="text-dark">Out of pocket expenses SGST (in %)</label>
                                    <input type="number" name="ope_sgst" id="ope_sgst" class="form-control" value="0"/>
                                  </div>
                                  <div class="form-group col-md-4">
                                    <label for="ope_cgst" class="text-dark">Out of pocket expenses CGST (in %)</label>
                                    <input type="number" name="ope_cgst" id="ope_cgst" class="form-control" value="0"/>
                                  </div>
                                </div>
                                  <div class="col-md-4 mb-4">
                                      <label for="igst" class="text-dark">Enter IGST (in %)</label>
                                      <input type="text" name="igst" id="igst" class="form-control" />
                                  </div>
                                  <div class="col-md-4 mb-4">
                                      <label for="sgst" class="text-dark">Enter SGST (in %)</label>
                                      <input type="text" name="sgst" id="sgst" class="form-control" />
                                  </div>
                                  <div class="col-md-4 mb-4">
                                      <label for="cgst" class="text-dark">Enter CGST (in %)</label>
                                      <input type="text" name="cgst" id=audit_plan"cgst" class="form-control" />
                                  </div>
                                  <div class="col-md-4 mb-4">
                                      <label for="igsta" class="text-dark">IGST Amount</label>
                                      <input type="text" name="igsta" id="igsta" class="form-control"/>
                                  </div>
                                  <div class="col-md-4 mb-4">
                                      <label for="sgsta" class="text-dark">SGST Amount</label>
                                      <input type="text" name="sgsta" id="sgsta" class="form-control"/>
                                  </div>
                                  <div class="col-md-4 mb-4">
                                      <label for="cgsta" class="text-dark">CGST Amount</label>
                                      <input type="text" name="cgsta" id="cgsta" class="form-control"/>
                                  </div>
                                </div>
                              </div>
                              {% else %}
                                Invoice already Generated with number : {{audit_plan.invoice_number}}
                              {% endif %}
                            </div>
                          
                        </div>
                        <div class="modal-footer">
                            <input type="submit" onclick="alert('The audit plan is locked. Now you cannot add new tasks in this client');" class="btn btn-success" value="SUBMIT">
                        </div>
                    </form>
                  </div>
            </div>
        </div>
        
    </section>
    <!-- /.content -->
  </div>
  <div class="modal fade" id="unlockAuditPlanModal" tabindex="-1">
    <div class="modal-dialog" role="document" style="max-width: 900px !important;">
        <div class="modal-content">
            <form action="{% url 'unlock_audit_plan' auditplan_id=audit_plan.id %}" method="POST" style="float:right">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Unlock Audit Plan</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
            </div>
              {% csrf_token %}
              
              <div class="modal-body">
                    <div class="form-row">
                      <div class="form-group col-md-12 mb-3">
                          <h6 class="float-center text-danger">AFTER UNLOCKING THE AUDIT PLAN ANY CHANGES IN THE MASTERS MAY AFFECT THE CURRENT AUDIT PLAN</h6>
                          <hr>
                          <label for="tasks" class="text-dark">ARE YOU SURE YOU WANT TO UNLOCK THE AUDIT PLAN ?</label>
                          <br>
                          <input type="checkbox" id="unlock_audit_plan" name="unlock_audit_plan" value="yes">
                          <label for="yes">YES</label>
                          <br>
                      </div>
                    </div>
                    <div class="form-row" id="unlock">
                      <div class="form-group col-md-12 mb-3">
                        <label for="password"> ENTER YOUR PASSWORD:</label>
                        <input type="password" class="form-control col-6" id="password" name="password">
                      </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <input type="submit" onclick="alert('The audit plan is UNLOCKED. Any changes to masters may affect the audit plan!!');" class="btn btn-success" value="SUBMIT">
                </div>
            </form>
          </div>
    </div>
</div>
  <!-- /.content-wrapper -->
  <footer class="main-footer">
  </footer>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- jQuery -->
<script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
<!-- jQuery UI 1.11.4 -->
<script src="{% static 'plugins/jquery-ui/jquery-ui.min.js' %}"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
  $.widget.bridge('uibutton', $.ui.button)
</script>
<!-- Bootstrap 4 -->
<script src="{% static 'plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- SweetAlert2 -->
<script src="{% static 'plugins/sweetalert2/sweetalert2.min.js' %}"></script>
<!-- ChartJS -->
<script src="{% static 'plugins/chart.js/Chart.min.js' %}"></script>
<!-- Sparkline -->
<script src="{% static 'plugins/sparklines/sparkline.js' %}"></script>
<!-- JQVMap -->
<script src="{% static 'plugins/jqvmap/jquery.vmap.min.js' %}"></script>
<script src="{% static 'plugins/jqvmap/maps/jquery.vmap.usa.js' %}"></script>
<!-- jQuery Knob Chart -->
<script src="{% static 'plugins/jquery-knob/jquery.knob.min.js' %}"></script>
<!-- daterangepicker -->
<script src="{% static 'plugins/moment/moment.min.js' %}"></script>
<script src="{% static 'plugins/daterangepicker/daterangepicker.js' %}"></script>
<!-- Tempusdominus Bootstrap 4 -->
<script src="{% static 'plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
<!-- Summernote -->
<script src="{% static 'plugins/summernote/summernote-bs4.min.js' %}"></script>
<!-- overlayScrollbars -->
<script src="{% static 'plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js' %}"></script>
<!-- DataTables -->
<script src="{% static 'plugins/datatables/jquery.dataTables.js' %}"></script>
<script src="{% static 'plugins/datatables-bs4/js/dataTables.bootstrap4.js' %}"></script>

<!-- Metis Menu -->
<script src="https://cdn.jsdelivr.net/npm/metismenu"></script>
<!-- AdminLTE App -->
<script src="{% static 'js/adminlte.js' %}"></script>
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<script src="{% static 'js/pages/dashboard.js' %}"></script>
<script>
  $("input").on("change", function() {
    var ret = parseInt((($("#igst").val()/100) * $("#invoice_amount").val() || '0'))
    $("#igsta").val(ret);
  })
</script>
<script>
  $("input").on("change", function() {
    var ret = parseInt((($("#sgst").val()/100) * $("#invoice_amount").val() || '0'))
    $("#sgsta").val(ret);
  })
</script>
<script>
  $("input").on("change", function() {
    var ret = parseInt((($("#cgst").val()/100) * $("#invoice_amount").val() || '0'))
    $("#cgsta").val(ret);
  })
</script>
<script>
  $("input").on("change", function() {
    var igst = parseInt(((($("#ope_igst").val()/100) * $("#out_of_pocket").val())  || '0'))
    var sgst = parseInt(((($("#ope_sgst").val()/100) * $("#out_of_pocket").val())  || '0'))
    var cgst = parseInt(((($("#ope_cgst").val()/100) * $("#out_of_pocket").val())  || '0'))
    ret = igst + cgst + sgst + parseInt($("#out_of_pocket").val());
    // ret = ret + parseInt($("#total_ope").val());
    $("#total_ope").val(ret);
  })
</script>
<script>
  $( document ).ready(function() {
      console.log( "ready!" );
      
  });
    $(() => {
        $('body').toggleClass('sidebar-collapse');
        
        $('#audit_plan').DataTable({
            "paging": true,
            "lengthChange": true,
            "searching": true,
            "ordering": true,
            "info": true,
            "autoWidth": false,
            "rowCallback":function(row,data,index){
              // console.log(typeof(data[9]))
              // var minutes = parseFloat(data[3])
              // if(minutes){
              //   const quotient = Math.floor(minutes/60);
              //   const remainder = minutes % 60;
              //   console.log(quotient, remainder)
              //   $(row).find('td:eq(3)').text(quotient+":"+remainder)
              // }
          }
        });

        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000
        });

        $('.swalDefaultSuccess').click(function() {
            Toast.fire({
                type: 'success',
                title: 'The task has been started'
            })
        });

         $('.taskSubmit').click(function() {
            Toast.fire({
                type: 'success',
                title: 'The submission for the task has been sent for approval!'
            })
        });

        $('.swalDefaultError').click(function() {
            Toast.fire({
                type: 'error',
                title: 'The task has been ended!'
            })
        });

        $('.metisFolder').metisMenu({
            toggle: false
        });

        // $("#ID")

        const activities = document.querySelectorAll('li[id^="activity"]');
        const tasks = document.querySelectorAll('li[id^="task"]');
        // console.log(tasks);
        var activities_seen = {};
        $.each(activities, (index, val) => {
          let activity = $(val).attr('id');
          console.log(activity);
          if (activities_seen[activity]) {
            // $('#' + activity).remove();
          } else {
            activities_seen[activity] = true;
          } 
        });

        var tasks_seen = {};
        $.each(tasks, (index, val) => {
          let task = $(val).attr('id');
          console.log(task);
          if (tasks_seen[task]) {
            $('#' + task).remove();
          } else {
            tasks_seen[task] = true;
          } 
        });
    });
</script>
<script>
    $('[name="start_billing"]').on('change', function() {
        $('#select').toggle(this.checked);
    }).change();
</script>
<script>
    $('[name="lock_audit_plan"]').on('change', function() {
        $('#lock').toggle(this.checked);
    }).change();
</script>
<script>
    $('[name="unlock_audit_plan"]').on('change', function() {
        $('#unlock').toggle(this.checked);
    }).change();
</script>
<script>
  $('[name="ope_add_gst"]').on('change', function() {
      $('#selectope').toggle(this.checked);
  }).change();
</script>
</body>
</html>
